<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Simultaneous confidence bands for functional parameters.">
<title>Fast n Fair Simultaneous Confidence Bands for Functional Parameters • ffscb</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fast n Fair Simultaneous Confidence Bands for Functional Parameters">
<meta property="og:description" content="Simultaneous confidence bands for functional parameters.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ffscb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="r-package-ffscb">R-package: ffscb<a class="anchor" aria-label="anchor" href="#r-package-ffscb"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
</div>
<div class="section level1">
<h1 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h1>
<p>The R package <code>ffscb</code> allows to compute simultaneous confidence bands for function-valued parameters (e.g. for mean functions <em>μ</em> = {<em>μ</em>(<em>t</em>) : <em>t</em> ∈ [0,1]}). The band shapes are constructed under the fairness constraint of <em>false positive rate balance</em> which allows to distribute the total false positive rate <em>α</em> ∈ (0,1) over partitions 0 = <em>a</em><sub>0</sub> &lt; <em>a</em><sub>1</sub> &lt; … &lt; <em>a</em><sub><em>p</em></sub> = 1 of the function domain [0,1].<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> This leads to band shapes that are interpretable both globally and locally. Globally (i.e. over the total domain [0,1]) the simultaneous confidence band provides a (1−<em>α</em>) × 100% coverage probability. Locally (i.e. over sub-intervals [<em>a</em><sub><em>j</em> − 1</sub>,<em>a</em><sub><em>j</em></sub>] ⊆ [0,1]) the simultaneous confidence band provides a (1−<em>α</em>(<em>a</em><sub><em>j</em></sub>−<em>a</em><sub><em>j</em> − 1</sub>)) × 100% coverage probability.</p>
<ul>
<li><p>The statistical theory and methodology are described in:<br> Fast ‘n’ fair simultaneous confidence bands for functional parameters as introduced in the paper <a href="https://arxiv.org/abs/1910.00131" class="external-link"><strong>Fast and Fair Simultaneous Confidence Bands for Functional Parameters</strong> (arXiv:1910.00131)</a> by <a href="www.dliebl.com">Dominik Liebl</a> and <a href="http://www.personal.psu.edu/mlr36/" class="external-link">Matthew Reimherr</a>.</p></li>
<li><p>The R-codes of the R package <code>ffscb</code> can be found at the GitHub repo <a href="https://github.com/lidom/ffscb" class="external-link uri">https://github.com/lidom/ffscb</a></p></li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"lidom/ffscb"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="small-example-based-on-artifical-data">Small example based on artifical data<a class="anchor" aria-label="anchor" href="#small-example-based-on-artifical-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"ffscb"</span><span class="op">)</span>
<span class="co"># Generate a sample</span>
<span class="va">p</span>          <span class="op">&lt;-</span> <span class="fl">200</span> 
<span class="va">N</span>          <span class="op">&lt;-</span> <span class="fl">80</span> 
<span class="va">grid</span>       <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_grid.html">make_grid</a></span><span class="op">(</span><span class="va">p</span>, rangevals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">mu</span>         <span class="op">&lt;-</span> <span class="fu"><a href="reference/meanf_poly.html">meanf_poly</a></span><span class="op">(</span><span class="va">grid</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.25</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">grid</span>
<span class="va">cov.m</span>      <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_cov_m.html">make_cov_m</a></span><span class="op">(</span>cov.f <span class="op">=</span> <span class="va">covf_nonst_matern</span>, grid<span class="op">=</span><span class="va">grid</span>, cov.f.params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample</span>     <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_sample.html">make_sample</a></span><span class="op">(</span><span class="va">mu</span>,<span class="va">cov.m</span>,<span class="va">N</span><span class="op">)</span>

<span class="co"># Compute the estimate, hat.mu, and its covariance, hat.cov.mu</span>
<span class="va">hat.mu</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>
<span class="va">hat.cov</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">-</span> <span class="va">hat.mu</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">N</span>
<span class="va">hat.cov.mu</span> <span class="op">&lt;-</span> <span class="va">hat.cov</span> <span class="op">/</span> <span class="va">N</span>
<span class="co"># Compute the tau-parameter </span>
<span class="co"># I.e., the 'roughness parameter function needed for the FFSCB-bands</span>
<span class="va">hat.tau</span>    <span class="op">&lt;-</span> <span class="fu"><a href="reference/tau_fun.html">tau_fun</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>

<span class="co"># Make and plot confidence bands</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_band.html">confidence_band</a></span><span class="op">(</span>x          <span class="op">=</span> <span class="va">hat.mu</span>, 
                     cov.x      <span class="op">=</span> <span class="va">hat.cov.mu</span>, 
                     tau        <span class="op">=</span> <span class="va">hat.tau</span>, 
                     df         <span class="op">=</span> <span class="va">N</span><span class="op">-</span><span class="fl">1</span>,
                     type       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FFSCB.t"</span>, <span class="st">"Bs"</span>, <span class="st">"BEc"</span>, <span class="st">"naive.t"</span><span class="op">)</span>,
                     conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
                     n_int      <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>Legend for band-<code>type</code>:</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="92%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>FFSCB.t</code></td>
<td align="left">Fast ‘n’ fair simultaneous confidence band of <a href="https://arxiv.org/abs/1910.00131" class="external-link">Liebl and Reimherr (2022+)</a>
</td>
</tr>
<tr class="even">
<td align="left"><code>Bs</code></td>
<td align="left">Bootstrap based simultaneous confidence band similar to <a href="http://www3.stat.sinica.edu.tw/statistica/j21n4/j21n412/j21n412.html" class="external-link">Degras (2011)</a>
</td>
</tr>
<tr class="odd">
<td align="left"><code>BEc</code></td>
<td align="left">Simultaneous confidence band of <a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssb.12239" class="external-link">Choi and Reimherr (2018)</a>
</td>
</tr>
<tr class="even">
<td align="left"><code>naive.t</code></td>
<td align="left">Naive pointwise confidence band (not a simultaneous confidence band)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="example-using-real-functional-data">Example using real functional data<a class="anchor" aria-label="anchor" href="#example-using-real-functional-data"></a>
</h2>
<p>The following code replicates the sports biomechanics real data example of our paper <a href="https://arxiv.org/abs/1910.00131" class="external-link">Liebl and Reimherr (2022+)</a>. First, we read in and plot the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"ffscb"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Biomechanics"</span><span class="op">)</span>
<span class="co">## Data</span>
<span class="va">slct_EC</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"Extra_Cush_"</span>,  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Biomechanics</span><span class="op">)</span><span class="op">)</span>
<span class="va">slct_NC</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"Normal_Cush_"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Biomechanics</span><span class="op">)</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">grid</span>         <span class="op">&lt;-</span> <span class="va">Biomechanics</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">100</span>   <span class="co"># Grid in [0,1]  </span>
<span class="va">EC_mat</span>       <span class="op">&lt;-</span> <span class="va">Biomechanics</span><span class="op">[</span>,<span class="va">slct_EC</span><span class="op">]</span> <span class="co"># Torque curves when running with extra  cushioned running shoes</span>
<span class="va">NC_mat</span>       <span class="op">&lt;-</span> <span class="va">Biomechanics</span><span class="op">[</span>,<span class="va">slct_NC</span><span class="op">]</span> <span class="co"># Torque curves when running with normal cushioned running shoes</span>
<span class="va">Dff_mat</span>      <span class="op">&lt;-</span> <span class="va">EC_mat</span> <span class="op">-</span> <span class="va">NC_mat</span>        <span class="co"># Difference curves</span>
<span class="va">N</span>            <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Dff_mat</span><span class="op">)</span>          <span class="co"># Sample size</span>

<span class="co">## Plot</span>
<span class="va">width</span>     <span class="op">&lt;-</span> <span class="fl">7</span>
<span class="va">height</span>    <span class="op">&lt;-</span> <span class="fl">2.5</span>
<span class="va">mar</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">1.1</span><span class="op">)</span>
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span>, ps<span class="op">=</span><span class="fl">13</span>, cex.main<span class="op">=</span><span class="fl">1.3</span>, cex.lab<span class="op">=</span><span class="fl">1.25</span>, cex.axis<span class="op">=</span><span class="fl">1.3</span>, font.main <span class="op">=</span> <span class="fl">1</span>, mar<span class="op">=</span><span class="va">mar</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">EC_mat</span>,  x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, lwd<span class="op">=</span><span class="fl">.5</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.25</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, 
        ylab<span class="op">=</span><span class="st">"N m / kg"</span>, xlab <span class="op">=</span> <span class="st">"% of Stance Phase"</span>, main<span class="op">=</span><span class="st">"Extra Cushioned\nRunning Shoe"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">NC_mat</span>,  x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, lwd<span class="op">=</span><span class="fl">.5</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.25</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, 
        ylab<span class="op">=</span><span class="st">"N m / kg"</span>, xlab <span class="op">=</span> <span class="st">"% of Stance Phase"</span>, main<span class="op">=</span><span class="st">"Normal Cushioned\nRunning Shoe"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Dff_mat</span>, x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, lwd<span class="op">=</span><span class="fl">.5</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Dff_mat</span><span class="op">)</span><span class="op">)</span>, 
        ylab<span class="op">=</span><span class="st">"N m / kg"</span>, xlab <span class="op">=</span> <span class="st">"% of Stance Phase"</span>, main<span class="op">=</span><span class="st">"Difference Curves\n(Extra - Normal)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Dff_mat</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Estimated mean"</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span>, lty<span class="op">=</span><span class="fl">1</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, cex<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>Next, we need to compute the estimate of the mean function <code>hat.mu</code> and the estimate of its covariance function <code>hat.cov.mu</code>. From the latter, we can compute the estimate of the roughness parameter <code>hat.tau</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Computing the estimates</span>
<span class="va">hat_mu</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Dff_mat</span><span class="op">)</span>
<span class="va">hat.cov</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Dff_mat</span> <span class="op">-</span> <span class="va">hat_mu</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">hat.cov.mu</span>   <span class="op">&lt;-</span> <span class="va">hat.cov</span> <span class="op">/</span> <span class="va">N</span>
<span class="va">hat.tau</span>      <span class="op">&lt;-</span> <span class="fu"><a href="reference/tau_fun.html">tau_fun</a></span><span class="op">(</span><span class="va">Dff_mat</span><span class="op">)</span> </code></pre></div>
<p>Now, we have everything in place to compute the fair simultaneous 95% confidence band that balances the false positive rate <em>α</em> = 0.05 by allocating the equal shares <em>α</em>(1/<code>n_int</code>) to each of the here <code>n_int=8</code> sub-intervalls [0,12.5%], [12.5%,25], …, [87.5%,100%].</p>
<p>Note: The paper treats also the case of balanced false positive rates over arbitrary partitions of the domain, but this feature is not yet implemented in our package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha.level</span>  <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">n_int</span>        <span class="op">&lt;-</span> <span class="fl">8</span>

<span class="co">## Over each subinterval [0, 12.5%], [12.5%, 25%], ... , [87.5%, 100%]  </span>
<span class="co">## we compute a 99.375% simultanouse confidence interval:</span>
<span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha.level</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n_int</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span> 
<span class="co">#&gt; [1] 99.375</span>

<span class="co">## Computing the confidence bands</span>
<span class="va">b</span>                 <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_band.html">confidence_band</a></span><span class="op">(</span>x          <span class="op">=</span> <span class="va">hat_mu</span>, 
                                     cov        <span class="op">=</span> <span class="va">hat.cov.mu</span>, 
                                     tau        <span class="op">=</span> <span class="va">hat.tau</span>, 
                                     df         <span class="op">=</span> <span class="va">N</span><span class="op">-</span><span class="fl">1</span>, 
                                     type       <span class="op">=</span><span class="st">"FFSCB.t"</span>, 
                                     conf.level <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">alpha.level</span>, 
                                     n_int      <span class="op">=</span> <span class="va">n_int</span><span class="op">)</span></code></pre></div>
<p>A quick and dirty plot can be generated by <code>plot(b)</code>. The following code, however, replicates the plot of our paper <a href="https://arxiv.org/abs/1910.00131" class="external-link">Liebl and Reimherr (2022+)</a>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">FF8_t_band</span>        <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> 
<span class="va">FF8_crit_value_u</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="va">FF8_t_band</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">hat_mu</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">hat.cov.mu</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Plots</span>
<span class="va">width</span>     <span class="op">&lt;-</span> <span class="fl">7</span>
<span class="va">height</span>    <span class="op">&lt;-</span> <span class="fl">3.125</span>
<span class="va">cex</span>       <span class="op">&lt;-</span> <span class="fl">.9</span>
<span class="va">cexs</span>      <span class="op">&lt;-</span> <span class="fl">0.95</span>
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,
       heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,     <span class="co"># Heights of the two rows</span>
       widths <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.25</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Widths of the two columns</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span>, ps<span class="op">=</span><span class="fl">13</span>, cex.axis<span class="op">=</span><span class="fl">1.05</span>, font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>, <span class="fl">2.1</span>, <span class="fl">2</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">hat.tau</span>,x<span class="op">=</span><span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, type<span class="op">=</span><span class="st">"l"</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Roughness estimate "</span>,<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>, <span class="fl">2.1</span>, <span class="fl">2</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FF8_crit_value_u</span><span class="op">)</span>, x<span class="op">=</span><span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, col<span class="op">=</span><span class="st">"black"</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, 
        main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">FF8_crit_value_u</span><span class="op">)</span>,<span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">:</span><span class="fl">8</span> <span class="op">*</span> <span class="fl">100</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"gray"</span>, lwd<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fair adaptive critical value function "</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">[</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"% of Stance Phase"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.25</span>, cex<span class="op">=</span><span class="va">cexs</span><span class="op">)</span>
<span class="co">## </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="fl">3.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span> y <span class="op">=</span> <span class="va">b</span>, x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, type<span class="op">=</span><span class="st">"n"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">FF8_t_band</span><span class="op">)</span>,<span class="fl">0.28</span><span class="op">)</span>, 
         ylab<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">grid</span><span class="op">*</span><span class="fl">100</span>,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">grid</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">FF8_t_band</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">FF8_t_band</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>  h <span class="op">=</span> <span class="fl">0</span>, lwd<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">:</span><span class="fl">8</span> <span class="op">*</span> <span class="fl">100</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>   y <span class="op">=</span> <span class="va">hat_mu</span>,  x <span class="op">=</span> <span class="va">grid</span><span class="op">*</span><span class="fl">100</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">4</span>, at <span class="op">=</span> <span class="fl">0</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">H</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">:</span><span class="op">~</span><span class="va">theta</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">50</span>, y<span class="op">=</span><span class="fl">0.3</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Estimated mean"</span><span class="op">)</span><span class="op">)</span>, 
                               <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">FF</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>, y.intersp<span class="op">=</span><span class="fl">1.05</span>, bg<span class="op">=</span><span class="st">"white"</span>, box.col <span class="op">=</span> <span class="st">"white"</span>,
       lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">10</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span><span class="va">cexs</span>, seg.len<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"% of Stance Phase"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.25</span>, cex<span class="op">=</span><span class="va">cexs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"N m / kg"</span>, <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2.5</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"95% Simultaneous Confidence Band (SCB)\n99.375% SCB over each subinterval"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">12.5</span><span class="op">/</span><span class="fl">2</span>, y <span class="op">=</span> <span class="fl">.2</span>, labels<span class="op">=</span><span class="st">"99.375% SCB"</span>, srt<span class="op">=</span><span class="fl">90</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="example-using-real-fragmentary-functional-data">Example using real fragmentary functional data<a class="anchor" aria-label="anchor" href="#example-using-real-fragmentary-functional-data"></a>
</h2>
<p>Our method even works in the case of fragmentary functional data, where it is impossible to compute estimates of the total covariance function. The following code replicates the framentary functional data example of our paper <a href="https://arxiv.org/abs/1910.00131" class="external-link">Liebl and Reimherr (2022+)</a>. First, we read in and plot the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"ffscb"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">)</span>

<span class="va">slct_Y_f</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"Y_f."</span>,  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">)</span><span class="op">)</span>
<span class="va">slct_X_f</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"X_f."</span>,  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">)</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">slct_Y_m</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"Y_m."</span>,  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">)</span><span class="op">)</span>
<span class="va">slct_X_m</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"X_m."</span>,  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">)</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">Y_f_mat</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">[</span>,<span class="va">slct_Y_f</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_f_mat</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">[</span>,<span class="va">slct_X_f</span><span class="op">]</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">Y_m_mat</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">[</span>,<span class="va">slct_Y_m</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_m_mat</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Fragments</span><span class="op">[</span>,<span class="va">slct_X_m</span><span class="op">]</span><span class="op">)</span>

<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">X_f_mat</span>, <span class="va">X_m_mat</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, 
            to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">X_f_mat</span>, <span class="va">X_m_mat</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, 
            len  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X_m_mat</span><span class="op">)</span><span class="op">)</span>

<span class="va">width</span>     <span class="op">&lt;-</span> <span class="fl">7</span>
<span class="va">height</span>    <span class="op">&lt;-</span> <span class="fl">3.8</span>
<span class="va">cex</span>       <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cexs</span>      <span class="op">&lt;-</span> <span class="fl">0.95</span>
<span class="va">mar</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.25</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span>
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"serif"</span>, ps<span class="op">=</span><span class="fl">13</span>, cex.main<span class="op">=</span><span class="fl">.99</span>, font.main <span class="op">=</span> <span class="fl">1</span>, mar<span class="op">=</span><span class="va">mar</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y_f_mat</span>, <span class="va">Y_m_mat</span><span class="op">)</span>,  
        x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X_f_mat</span>, <span class="va">X_m_mat</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"n"</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.45</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y_f_mat</span>, <span class="va">Y_m_mat</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y_f_mat</span>,  x<span class="op">=</span><span class="va">X_f_mat</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Y_f_mat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, x<span class="op">=</span><span class="va">grid</span>,    lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y_m_mat</span>,  x<span class="op">=</span><span class="va">X_m_mat</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Y_m_mat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, x<span class="op">=</span><span class="va">grid</span>,    lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>, 
       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">1.5</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex <span class="op">=</span> <span class="va">cexs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Estimated mean (female)"</span>,
                                 <span class="st">"Estimated mean (male)"</span><span class="op">)</span>, 
       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">1.5</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex <span class="op">=</span> <span class="va">cexs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Spinal BMD"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Age"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.25</span>, cex<span class="op">=</span><span class="va">cexs</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>Next, we need to compute the estimates of the mean functions <code>hat_mu_f</code> and <code>hat_mu_m</code> and the estimates of the covariance functions <code>hat_cov_f</code> and <code>hat_cov_f</code>. Due to the fragmentary nature of the data, we can only estimate the covariance functions at a band along the diagonal of the covarianc functions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hat_mu_f</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Y_f_mat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># mean function estimate (female)</span>
<span class="va">hat_mu_m</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">Y_m_mat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># mean function estimate (male)</span>
<span class="co">##</span>
<span class="va">hat_cov_f</span>  <span class="op">&lt;-</span> <span class="fu"><a href="reference/cov_fragments.html">cov_fragments</a></span><span class="op">(</span><span class="va">Y_f_mat</span><span class="op">)</span> <span class="co"># covariance function estimate (female)</span>
<span class="va">hat_cov_m</span>  <span class="op">&lt;-</span> <span class="fu"><a href="reference/cov_fragments.html">cov_fragments</a></span><span class="op">(</span><span class="va">Y_m_mat</span><span class="op">)</span> <span class="co"># covariance function estimate (male)</span>
<span class="co">##</span>
<span class="va">width</span>     <span class="op">&lt;-</span> <span class="fl">7.1</span>
<span class="va">height</span>    <span class="op">&lt;-</span> <span class="fl">3.7</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"serif"</span>, ps<span class="op">=</span><span class="fl">13</span>, cex.main<span class="op">=</span><span class="fl">.99</span>, font.main <span class="op">=</span> <span class="fl">1</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">hat_cov_f</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,len<span class="op">=</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Age"</span>, ylab <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Female"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">hat_cov_m</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,len<span class="op">=</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Age"</span>, ylab <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Male"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>Based on <code>hat_cov_f</code> and <code>hat_cov_f</code>, we can compute the covariance estimate <code>hat_cov_mat</code> of the two-sample mean difference <code>hat_mu_f - hat_mu_m</code>. Based on <code>hat_cov_mat</code>, we can compute the roughness parameter <code>hat.tau</code>; even though, <code>hat_cov_mat</code> can only be computed along a band around the diagonal.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_f</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X_f_mat</span><span class="op">)</span> <span class="co"># Number of female subjects</span>
<span class="va">N_m</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X_m_mat</span><span class="op">)</span> <span class="co"># Number of male subjects</span>
<span class="co">##</span>
<span class="co"># number of observations X_i(t)*X_i(s), i=1,...,N_f, for each (t,s) grid point</span>
<span class="va">n_f_ts</span>       <span class="op">&lt;-</span> <span class="fu"><a href="reference/n_ts.html">n_ts</a></span><span class="op">(</span><span class="va">Y_f_mat</span><span class="op">)</span>;  <span class="va">n_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n_f_ts</span><span class="op">)</span> 
<span class="co"># number of observations X_i(t)*X_i(s), i=1,...,N_m, for each (t,s) grid point</span>
<span class="va">n_m_ts</span>       <span class="op">&lt;-</span> <span class="fu"><a href="reference/n_ts.html">n_ts</a></span><span class="op">(</span><span class="va">Y_m_mat</span><span class="op">)</span>;  <span class="va">n_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n_m_ts</span><span class="op">)</span> 
<span class="co">##</span>
<span class="va">hat_cov_mat</span>  <span class="op">&lt;-</span> <span class="op">(</span> <span class="op">(</span><span class="va">n_f_ts</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">hat_cov_f</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_m_ts</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">hat_cov_m</span> <span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_f_ts</span> <span class="op">+</span> <span class="va">n_m_ts</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span>
<span class="va">diag_cov</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">hat_cov_mat</span><span class="op">)</span>
<span class="va">diag_cov_x</span>   <span class="op">&lt;-</span> <span class="va">diag_cov</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_f</span> <span class="op">+</span> <span class="va">n_m</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">tau</span>          <span class="op">&lt;-</span> <span class="fu"><a href="reference/cov2tau_fun.html">cov2tau_fun</a></span><span class="op">(</span><span class="va">hat_cov_mat</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">b</span>            <span class="op">&lt;-</span> <span class="fu"><a href="reference/confidence_band_fragm.html">confidence_band_fragm</a></span><span class="op">(</span>x  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">hat_mu_f</span> <span class="op">-</span> <span class="va">hat_mu_m</span><span class="op">)</span>, 
                                      diag.cov.x <span class="op">=</span> <span class="va">diag_cov_x</span>, 
                                      tau        <span class="op">=</span> <span class="va">tau</span>, 
                                      df         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_f</span>,<span class="va">n_m</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, 
                                      type       <span class="op">=</span> <span class="st">"FFSCB.t"</span>, 
                                      conf.level <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.05</span><span class="op">)</span>, 
                                      n_int      <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">slct_FFSCB_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"FFSCB.t"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>

<span class="va">hat_mu_diff</span>  <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">FFSCB_t_band</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span>,<span class="va">slct_FFSCB_t</span><span class="op">]</span> <span class="co">#FFSCB_res$band[,-1]</span>


<span class="va">width</span>     <span class="op">&lt;-</span> <span class="fl">7</span>
<span class="va">height</span>    <span class="op">&lt;-</span> <span class="fl">3.8</span>
<span class="va">cex</span>       <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cexs</span>      <span class="op">&lt;-</span> <span class="fl">0.95</span>
<span class="va">mar</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.25</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span>
<span class="co">##</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"serif"</span>, ps<span class="op">=</span><span class="fl">13</span>, cex.main<span class="op">=</span><span class="fl">.99</span>, font.main <span class="op">=</span> <span class="fl">1</span>, mar<span class="op">=</span><span class="va">mar</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FFSCB_t_band</span><span class="op">)</span>,  x<span class="op">=</span><span class="va">grid</span>, type<span class="op">=</span><span class="st">"n"</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">grid</span>,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span><span class="op">)</span>, 
        y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">FFSCB_t_band</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">FFSCB_t_band</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>  h <span class="op">=</span> <span class="fl">0</span>, lwd<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>   y <span class="op">=</span> <span class="va">hat_mu_diff</span>,  x <span class="op">=</span> <span class="va">grid</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">4</span>, at <span class="op">=</span> <span class="fl">0</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">H</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">:</span><span class="op">~</span><span class="va">theta</span><span class="op">[</span><span class="va">f</span><span class="op">]</span><span class="op">-</span><span class="va">theta</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">11</span>, y<span class="op">=</span><span class="op">-</span><span class="fl">0.01</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Estimated mean diff."</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">FF</span><span class="op">[</span><span class="st">"frag,t"</span><span class="op">]</span><span class="op">^</span><span class="st">"2,2S"</span><span class="op">)</span><span class="op">)</span>, 
       lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">10</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.75</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span><span class="va">cexs</span>, seg.len<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="co">#x=10.5,y=-0.11</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Differences in mean functions"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.4</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex<span class="op">=</span><span class="va">cex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Age"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.25</span>, cex<span class="op">=</span><span class="va">cexs</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>More detailes about this real-ata application can be found in our paper <a href="https://arxiv.org/abs/1910.00131" class="external-link">Liebl and Reimherr (2022+)</a>.</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Using a standardized function domain [0,1] is, for course, without loss of generality.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ffscb</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dominik Liebl <br><small class="roles"> Author, maintainer </small>  </li>
<li>Matthew Reimherr <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/lidom/ffscb/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/lidom/ffscb/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/lidom/ffscb/actions/workflows/pages/pages-build-deployment" class="external-link"><img src="https://github.com/lidom/ffscb/actions/workflows/pages/pages-build-deployment/badge.svg" alt="pages-build-deployment"></a></li>
<li><a href="https://github.com/lidom/ffscb/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/lidom/ffscb/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://github.com/lidom/ffscb/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/lidom/ffscb/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dominik Liebl, Matthew Reimherr.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
