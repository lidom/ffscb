<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Makes confidence bands"><title>Makes confidence bands — confidence_band • ffscb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Makes confidence bands — confidence_band"><meta property="og:description" content="Makes confidence bands"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ffscb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Makes confidence bands</h1>
      
      <div class="d-none name"><code>confidence_band.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Makes confidence bands</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">confidence_band</span><span class="op">(</span>
  <span class="va">x</span>,
  <span class="va">cov.x</span>,
  tau <span class="op">=</span> <span class="cn">NULL</span>,
  df <span class="op">=</span> <span class="cn">NULL</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FFSCB.z"</span>, <span class="st">"FFSCB.t"</span>, <span class="st">"BEc"</span>, <span class="st">"Bs"</span>, <span class="st">"naive.t"</span><span class="op">)</span>,
  conf.level <span class="op">=</span> <span class="fl">0.95</span>,
  grid.size <span class="op">=</span> <span class="fl">200</span>,
  Bs.sim.size <span class="op">=</span> <span class="fl">10000</span>,
  n_int <span class="op">=</span> <span class="fl">4</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Functional parameter estimate (for instance, the empirical mean function). It can be either a vector or fd object from the fda package.</p></dd>


<dt>cov.x</dt>
<dd><p>Cov(x), in which x is the functional estimator (for instance, the covariance function of the empirical mean function). It can be either matrix or bifd object from fda. The eigen decomposition of Cov(X) can be used instead.</p></dd>


<dt>tau</dt>
<dd><p>Pointwise standard deviation of the standardized and differentiated sample functions. Can be estimated by tau_fun().</p></dd>


<dt>df</dt>
<dd><p>Degrees of freedom parameter for the t-distribution based bands 'FFSCB.t' and 'naive.t'. If x is the empirical mean function, set df=n-1, where n denotes the sample size.</p></dd>


<dt>type</dt>
<dd><p>The band(s) to be constructed.</p><ul><li><p>FFSCB.z : Fast'n'Fair (adaptive) simultaneous confidence band based for a Gaussian functional parameter estimate.</p></li>
<li><p>FFSCB.t : Fast'n'Fair (adaptive) simultaneous confidence band based for a t-distributed functional parameter estimate.</p></li>
<li><p>BEc : The suggested modified Scheffe style band from hyper-ellipsoie Ec, which uses up to the very last dimension.</p></li>
<li><p>Bs : Parametric bootstrap simultaneous confidence band, similar to the one appeard in Degras(2011) (for comparision purpose)</p></li>
<li><p>naive.t : A collection of point-wise t-intervals. (for comparision purpose)</p></li>
</ul></dd>


<dt>conf.level</dt>
<dd><p>A vector of confidence levels for the bands to achieve.</p></dd>


<dt>grid.size</dt>
<dd><p>This determines on how fine grid the bands will be constructed before converted as an `fd' object. This parameter is used only when 'x' is fd object and 'cov.x' is bifd object.</p></dd>


<dt>Bs.sim.size</dt>
<dd><p>This determines bootstrap sample size for Bs</p></dd>


<dt>n_int</dt>
<dd><p>Number of intervals for the piecewise linear confidence bounds.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>confidence_band Either a collection of vector valued bands or `fd' object whose objectname is changed to confidence_band.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Liebl, D. and Reimherr, M. (2022+). Fast and fair simultaneous confidence bands.</p></li>
<li><p>Choi, H. and Reimherr, M. (2018). A geometric approach to confidence regions and bands for functional parameters. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 80 239-260.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Generate a sample</span></span>
<span class="r-in"><span class="va">p</span>          <span class="op">&lt;-</span> <span class="fl">200</span> </span>
<span class="r-in"><span class="va">N</span>          <span class="op">&lt;-</span> <span class="fl">80</span> </span>
<span class="r-in"><span class="va">grid</span>       <span class="op">&lt;-</span> <span class="fu"><a href="make_grid.html">make_grid</a></span><span class="op">(</span><span class="va">p</span>, rangevals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mu0</span>        <span class="op">&lt;-</span> <span class="fu"><a href="meanf_poly.html">meanf_poly</a></span><span class="op">(</span><span class="va">grid</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>   </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mu0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">grid</span></span>
<span class="r-in"><span class="va">mu</span>         <span class="op">&lt;-</span> <span class="fu"><a href="meanf_poly.html">meanf_poly</a></span><span class="op">(</span><span class="va">grid</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">grid</span></span>
<span class="r-in"><span class="va">cov.m</span>      <span class="op">&lt;-</span> <span class="fu"><a href="make_cov_m.html">make_cov_m</a></span><span class="op">(</span>cov.f <span class="op">=</span> <span class="va">covf_st_matern</span>, grid<span class="op">=</span><span class="va">grid</span>, cov.f.params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sample</span>     <span class="op">&lt;-</span> <span class="fu"><a href="make_sample.html">make_sample</a></span><span class="op">(</span><span class="va">mu</span>,<span class="va">cov.m</span>,<span class="va">N</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute the estimate and its covariance</span></span>
<span class="r-in"><span class="va">hat.mu</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span class="r-in"><span class="va">hat.cov</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">-</span> <span class="va">hat.mu</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">N</span></span>
<span class="r-in"><span class="va">hat.cov.mu</span> <span class="op">&lt;-</span> <span class="va">hat.cov</span> <span class="op">/</span> <span class="va">N</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute the tau-parameter </span></span>
<span class="r-in"><span class="va">hat.tau</span>    <span class="op">&lt;-</span> <span class="fu"><a href="tau_fun.html">tau_fun</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Make and plot confidence bands</span></span>
<span class="r-in"><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">confidence_band</span><span class="op">(</span>x<span class="op">=</span><span class="va">hat.mu</span>, cov.x<span class="op">=</span><span class="va">hat.cov.mu</span>, tau<span class="op">=</span><span class="va">hat.tau</span>, df<span class="op">=</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span>,</span>
<span class="r-in">                     type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FFSCB.t"</span>, <span class="st">"Bs"</span>,<span class="st">"BEc"</span>,<span class="st">"naive.t"</span><span class="op">)</span>,</span>
<span class="r-in">                     conf.level  <span class="op">=</span> <span class="fl">0.95</span>, n_int<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">grid</span>, y<span class="op">=</span><span class="va">mu0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="confidence_band-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Dominik Liebl, Matthew Reimherr.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

